SELECT count(*) membership FROM SELLER_REG_INFO sri ,MEMBERSHIP m WHERE sri.id  = m.id;
SELECT count(*) FROM SELLER_REG_INFO sri WHERE auth = '판매자';
SELECT count(*) FROM MEMBER_INFORMATION mi ;

SELECT c.CART_NUM,(p.price*c.COUNT) total_price  ,p.*,c.id,c.COUNT 
FROM cart c, PRODUCT p WHERE c.PRODUCT_NUM =p.PRODUCT_NUM ;

INSERT INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE)
VALUES (100,102,'2023-06-01',510000);
INSERT INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE)
VALUES (101,102,'2023-05-01',510000);
INSERT INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE)
VALUES (102,103,'2023-04-01',520000);

ALTER TABLE ORDER_INFO DROP COLUMN order_price;
ALTER TABLE ORDER_info ADD order_price NUMBER;

DELETE FROM ORDER_INFO oi WHERE cart_num=102;

SELECT * FROM ORDER_INFO oi ;
SELECT * FROM cart;
SELECT * FROM PRODUCT p ;

INSERT ALL
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (103,102,'2023-04-22',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (104,102,'2023-04-12',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (105,103,'2023-05-25',520000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (106,103,'2023-05-01',520000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (107,102,'2023-05-08',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (108,102,'2023-06-10',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (109,103,'2023-06-11',520000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (110,103,'2023-06-13',520000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (111,102,'2023-06-28',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (112,102,'2023-07-25',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (113,103,'2023-08-02',520000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (114,103,'2023-08-08',520000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (115,102,'2023-08-11',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (116,102,'2023-08-11',510000)
INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (117,103,'2023-08-19',520000)
SELECT * FROM dual;

INSERT INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (118,102,'2023-07-03',510000);
INSERT INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (119,102,'2023-07-07',510000);
INSERT INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (120,102,'2023-07-13',510000);
INSERT INTO ORDER_INFO (ORDER_NUM,CART_NUM,ORDER_DATE,ORDER_PRICE) VALUES (121,102,'2023-07-29',510000);

SELECT nvl("JAN",0) AS JAN, nvl("FEB",0) FEB, nvl("MAR",0) MAR,nvl("APR",0) APR,
	nvl("MAY",0) MAY, nvl("JUN",0) JUN, nvl("JUL",0) JUL,nvl("AUG",0) AUG,
	nvl("SEP",0) SEP, nvl("OCT",0) OCT,nvl("NOV",0) NOV,nvl("DEC",0) DEC
FROM (
 	  SELECT TO_CHAR(order_date, 'YYYY-MM') AS order_month, NVL(order_price, 0) AS order_price
    FROM ORDER_INFO
)
PIVOT (
    sum(order_price) FOR order_month IN (
        '2023-01' AS "JAN",
        '2023-02' AS "FEB",
        '2023-03' AS "MAR",
        '2023-04' AS "APR",
        '2023-05' AS "MAY",
        '2023-06' AS "JUN",
        '2023-07' AS "JUL",
        '2023-08' AS "AUG",
        '2023-09' AS "SEP",
        '2023-10' AS "OCT",
        '2023-11' AS "NOV",
        '2023-12' AS "DEC"
    )
    
);

-- 현월 총매출
SELECT sum(ORDER_PRICE) FROM ORDER_INFO WHERE EXTRACT (MONTH FROM sysdate) = EXTRACT (MONTH FROM order_date) ;
-- 현연 총매출
SELECT sum(ORDER_PRICE) FROM ORDER_INFO WHERE EXTRACT (year FROM sysdate) = EXTRACT (year FROM order_date);
SELECT EXTRACT (MONTH FROM sysdate) FROM dual;

SELECT count(*) FROM ORDER_INFO WHERE SHIP_STATE = '배송완료';
SELECT count(*) FROM ORDER_INFO;

INSERT INTO MEMBERSHIP m2 VALUES ('park1234','2023-04-02','2023-07-02');
UPDATE PRODUCT SET FOR_SALE = 0 WHERE id='park1234';
SELECT * FROM MEMBERSHIP m ;
SELECT * FROM PRODUCT p2 ORDER BY PRODUCT_NUM ;
INSERT INTO product values(1005,'nhw1234','유기농 머루',35000,'2023-05-15',1);
INSERT INTO product values(1006,'nhw1234','산딸기',47500,'2023-06-05',1);
INSERT INTO product values(1007,'kkw1234','수박',26000,'2023-05-22',1);

SELECT * FROM PRODUCT p ;
INSERT INTO membership VALUES (1001,'2023-05-01','2023-08-01');
INSERT INTO membership VALUES (1002,'2023-05-01','2023-08-01');
INSERT INTO membership VALUES (1005,'2023-05-01','2023-08-01');
INSERT INTO membership VALUES (1006,'2023-05-01','2023-08-01');



SELECT * FROM PRODUCT;
-- 판매자 정보 + 멤버쉽 정보 + 판매 상품
SELECT m.*,sri.NAME,sri.CONTACT,sri.BUSINESS_NUM,p.PRODUCT_NAME 
FROM MEMBERSHIP m,SELLER_REG_INFO sri,PRODUCT p
WHERE m.product_num=p.PRODUCT_NUM  AND sri.ID=p.ID;

SELECT * FROM PRODUCT p ORDER BY PRODUCT_NUM ;
SELECT * FROM MEMBERSHIP m ORDER BY PRODUCT_NUM ;
INSERT INTO MEMBERSHIP m (PRODUCT_NUM) VALUES (1003);
INSERT INTO MEMBERSHIP m (PRODUCT_NUM) VALUES (1004);
INSERT INTO MEMBERSHIP m (PRODUCT_NUM) VALUES (1007);

-- 판매자 정보 + 판매 상품
SELECT sri.*,p.PRODUCT_NAME  FROM SELLER_REG_INFO sri ,PRODUCT p
WHERE sri.id=p.id;
-- 카운트
SELECT sri.*,p.PRODUCT_NAME  FROM SELLER_REG_INFO sri ,PRODUCT p
WHERE sri.id=p.id;

-- 멤버쉽 정보 + 판매 상품 카운트
SELECT count(*) FROM MEMBERSHIP m ,PRODUCT p WHERE m.PRODUCT_NUM=p.PRODUCT_NUM ;
-- 전체 상품 카운트
SELECT count(*) FROM PRODUCT p ;

SELECT 
SELECT
    CASE
        WHEN p.FOR_SALE = 0 THEN '품절'
        WHEN p.FOR_SALE = 1 THEN '판매중'
    END AS FOR_SAle
FROM PRODUCT p ;

SELECT
    sri.*,
    p.PRODUCT_NAME,
    CASE
        WHEN p.FOR_SALE = 0 THEN '준비중'
        WHEN p.FOR_SALE = 1 THEN '판매중'
    END AS FOR_SALE
FROM
    SELLER_REG_INFO sri
JOIN
    PRODUCT p
ON
    sri.id = p.id;

-- 판매자 정보 + 멤버쉽 정보 + 판매 상품
SELECT 
	m.*,sri.NAME,sri.BUSINESS_NUM,p.PRODUCT_NAME 
FROM MEMBERSHIP m,SELLER_REG_INFO sri,PRODUCT p
WHERE m.id=sri.ID AND sri.ID=p.ID;

UPDATE product SET PRODUCT_NAME = REPLACE(PRODUCT_NAME,'/',' ')
WHERE PRODUCT_NAME LIKE '%/%';

SELECT * FROM MEMBERSHIP m ;
UPDATE MEMBERSHIP SET mems_begin_date = '2018-09-09'
	WHERE PRODUCT_NUM = 1007;
	

-- 
SELECT
	sri.id,
    m.product_num,
    nvl(m.MEMS_BEGIN_DATE,'') MEMS_BEGIN_DATE,
    nvl(m.MEMS_END_DATE,'') MEMS_END_DATE,
    sri.NAME,
    sri.BUSINESS_NUM,
    p.PRODUCT_NAME productname,
    CASE
        WHEN p.FOR_SALE = 0 THEN '준비중'
        WHEN p.FOR_SALE = 1 THEN '판매중'
        ELSE 'Unknown'
    END AS FOR_SALE
FROM
    MEMBERSHIP m,
    PRODUCT p,
    SELLER_REG_INFO sri
WHERE
	sri.id = p.id and
	m.product_num = p.product_num
ORDER BY MEMS_END_DATE desc;

    
    
    
--JOIN
--    PRODUCT p
--ON
--    m.product_num = p.product_num
--JOIN
--    SELLER_REG_INFO sri
--ON
--    sri.ID = p.ID;

   



